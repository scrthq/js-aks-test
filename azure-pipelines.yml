variables:
  - group: deployment-vars

trigger:
  branches:
    include:
      - main

pool:
  name: ubuntu-latest
  container: pulumi/pulumi-python:latest

stages:
  - stage: preview
    displayName: pulumi preview
    variables:
      PULUMI_ACCESS_TOKEN: $(PULUMI_ACCESS_TOKEN)
    jobs:
      - job: preview

        dependsOn: []
        displayName: pulumi preview
        steps:
          - script: pulumi version
          - task: Pulumi@1
            inputs:
              azureSubscription: 'Free Trial(9589b86c-0184-4e83-995c-559cbf7b723a)'
              command: 'preview'
              stack: '$(Build.SourceBranchName)'
          